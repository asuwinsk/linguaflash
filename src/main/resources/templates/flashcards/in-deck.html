<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Flashcards in Deck</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <style>
    .thick-border {
      border: 3px solid #343a40 !important;
    }
    .thick-border th, .thick-border td {
      border: 2px solid #343a40 !important;
    }
  </style>
</head>
<body>
<div class="container mt-5">
  <div th:if="${success}" class="alert alert-success" th:text="${success}"></div>

  <h1 class="mb-4 text-center">
    Flashcards in Deck:
    <span th:text="${deck.name}">Deck name</span>
  </h1>

  <div class="mb-3" th:if="${flashcardsPage}">
    <span>
      Loaded flashcards:
      <strong th:text="${flashcardsPage.numberOfElements}">0</strong>
      of
      <strong th:text="${flashcardsPage.totalElements}">0</strong>
      (page <span th:text="${flashcardsPage.number + 1}">1</span>
      / <span th:text="${flashcardsPage.totalPages == 0 ? 1 : flashcardsPage.totalPages}">1</span>)
    </span>
  </div>
  <div class="my-4 d-grid" role="navigation" aria-label="Learning actions">
    <a th:href="@{|/view/decks/${deck.id}/learn|}"
       class="btn btn-primary btn-lg py-3">
      Let's Learn!
    </a>
  </div>


  <table class="table table-striped table-bordered thick-border"
         th:if="${flashcardsPage != null and flashcardsPage.numberOfElements > 0}">
    <thead class="table-primary">
    <tr>
      <th style="width: 120px;">
        <a th:href="@{|/view/decks/${deck.id}/flashcards?page=0&size=${pageSize}&sort=id&dir=${currentSort=='id' and currentDir=='asc' ? 'desc' : 'asc'}|}">
          ID
          <span class="sort-caret" th:if="${currentSort=='id'}"
                th:text="${currentDir=='asc' ? '▲' : '▼'}"></span>
        </a>
      </th>
      <th>
        <a th:href="@{|/view/decks/${deck.id}/flashcards?page=0&size=${pageSize}&sort=front&dir=${currentSort=='front' and currentDir=='asc' ? 'desc' : 'asc'}|}">
          Front
          <span class="sort-caret" th:if="${currentSort=='front'}"
                th:text="${currentDir=='asc' ? '▲' : '▼'}"></span>
        </a>
      </th>
      <th>
        <a th:href="@{|/view/decks/${deck.id}/flashcards?page=0&size=${pageSize}&sort=back&dir=${currentSort=='back' and currentDir=='asc' ? 'desc' : 'asc'}|}">
          Back
          <span class="sort-caret" th:if="${currentSort=='back'}"
                th:text="${currentDir=='asc' ? '▲' : '▼'}"></span>
        </a>
      </th>
      <th style="width: 160px;">Actions</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="flashcard : ${flashcardsPage.content}">
      <td>
        <a th:href="@{/view/flashcards/{id}(id=${flashcard.id})}" th:text="${flashcard.id}"></a>
      </td>
      <td th:text="${flashcard.front}">Front text</td>
      <td th:text="${flashcard.back}">Back text</td>
      <td>
        <a th:href="@{|/view/decks/${deck.id}/flashcards/delete/${flashcard.id}|}"
           class="btn btn-sm btn-danger"
           onclick="return confirm('Delete this flashcard from the deck?');">
          Delete
        </a>
      </td>
    </tr>
    </tbody>
  </table>

  <div class="mb-3 d-flex gap-2">
    <a th:href="@{'/view/decks/' + ${deck.id} + '/flashcards/select'}"
       class="btn btn-success">
      Add flashcards
    </a>
    <a th:href="@{|/view/decks/${deck.id}|}" class="btn btn-secondary">Back to Deck</a>
  </div>

  <div th:if="${flashcardsPage != null and flashcardsPage.totalElements == 0}" class="alert alert-warning">
    No flashcards found in this deck.
  </div>

  <!-- Paginacja -->
  <nav th:if="${flashcardsPage != null and flashcardsPage.totalPages > 1}" aria-label="Flashcards pagination">
    <ul class="pagination">
      <li class="page-item" th:classappend="${flashcardsPage.first} ? 'disabled'">
        <a class="page-link"
           th:href="@{|/view/decks/${deck.id}/flashcards?page=${flashcardsPage.number - 1}&size=${pageSize}&sort=${currentSort}&dir=${currentDir}|}">
          Previous
        </a>
      </li>

      <li class="page-item"
          th:each="i : ${#numbers.sequence(0, flashcardsPage.totalPages - 1)}"
          th:classappend="${i == flashcardsPage.number} ? 'active'">
        <a class="page-link"
           th:text="${i + 1}"
           th:href="@{|/view/decks/${deck.id}/flashcards?page=${i}&size=${pageSize}&sort=${currentSort}&dir=${currentDir}|}">
        </a>
      </li>

      <li class="page-item" th:classappend="${flashcardsPage.last} ? 'disabled'">
        <a class="page-link"
           th:href="@{|/view/decks/${deck.id}/flashcards?page=${flashcardsPage.number + 1}&size=${pageSize}&sort=${currentSort}&dir=${currentDir}|}">
          Next
        </a>
      </li>
    </ul>
  </nav>
</div>
</body>
</html>